#!/usr/bin/env bash
# vim: filetype=bash

set -euo pipefail

# Pretty print functions
info()    { echo -e "\033[1;34m[INFO]\033[0m $*"; }
warn()    { echo -e "\033[1;33m[WARN]\033[0m $*"; }
error()   { echo -e "\033[1;31m[ERROR]\033[0m $*"; }
success() { echo -e "\033[1;32mâœ… $*\033[0m"; }

#Install opencode
info ">>> Installing opencode"

{{ if (or (eq .chezmoi.osRelease.id "endeavouros") (eq .chezmoi.osRelease.id "cachyos")) }}

if command -v "paru" > /dev/null; then
  info ">>> Installing opencode using paru"
  paru -Sy --noconfirm --needed opencode-bin
  success ">>> Installed Opencode"
else
  info ">>> Installing opencode using curl"
  curl -fsSL https://opencode.ai/install | bash
  success ">>> Installed Opencode"
fi

{{ else }}
  info ">>> Installing opencode using curl"
  curl -fsSL https://opencode.ai/install | bash
{{ end }}


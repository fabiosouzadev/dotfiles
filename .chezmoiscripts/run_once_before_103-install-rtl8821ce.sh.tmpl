#!/usr/bin/env bash
# vim: filetype=bash


{{-  if .rtl8821ce.enabled }}

{{ if (or (eq .chezmoi.osRelease.id "endeavouros") (eq .chezmoi.osRelease.id "cachyos")) }}

sudo pacman -S --noconfirm --needed linux-headers dkms bc

if type -P paru >/dev/null 2>&1; then
  paru -Sy --noconfirm --needed rtl8821ce-dkms-git
elif type -P yay >/dev/null 2>&1; then
  yay -Sy --noconfirm --needed rtl8821ce-dkms-git
fi
{{ end }}

{{ if eq .chezmoi.osRelease.id "ubuntu" -}}
sudo apt install -y bc module-assistant build-essential dkms
sudo m-a prepare
git clone https://github.com/tomaspinho/rtl8821ce.git /tmp/rtl8821ce
cd /tmp/rtl8821ce
sudo ./dkms-install.sh

cd ~
sudo rm -vr /tmp/rtl8821ce

{{ end }}

{{- end }}

#!/usr/bin/env bash
# vim: filetype=bash

{{ if (or (eq .chezmoi.osRelease.id "endeavouros") (eq .chezmoi.osRelease.id "cachyos")) }}
set -euo pipefail

# Pretty print functions
info()    { echo -e "\033[1;34m[INFO]\033[0m $*"; }
warn()    { echo -e "\033[1;33m[WARN]\033[0m $*"; }
error()   { echo -e "\033[1;31m[ERROR]\033[0m $*"; }
success() { echo -e "\033[1;32mâœ… $*\033[0m"; }


if ! command -v "paru" > /dev/null; then
	info "Installing Paru"
	sudo pacman -S --needed base-devel git
	cd /tmp # && git clone https://aur.archlinux.org/paru.git
	cd paru
	makepkg -rsi --noconfirm
	cd ~ && rm -Rf /tmp/paru/
	sudo sed -i -e 's/^#Color/Color/' --e 's/^#BottomUp/BottomUp/' -e 's/^#SudoLoop/SudoLoop/' -e 's/^#CombinedUpgrade/CombinedUpgrade/' -e 's/^#UpgradeMenu/UpgradeMenu/' -e 's/^#NewsOnUpgrade/NewsOnUpgrade/' /etc/paru.conf
	echo "SkipReview" | sudo tee -a /etc/paru.conf > /dev/null
	paru --gendb;
	success "Paru Installed"
fi

{{ end -}}
